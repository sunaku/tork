<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="md2man 2.0.2 https://github.com/sunaku/md2man" />
  <title>tork-master(1) &mdash; absorbs overhead and runs tests</title>
  <link rel="stylesheet" href="../style.css"/>
  <!--[if lt IE 9]><script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
</head>
<body><div class="navbar"><div class="navbar-inner"><span class="brand"><a href="../index.html#man1">man1</a>/tork-master.1</span></div></div><div class="container-fluid"><h1 id="TORK-MASTER-1-2014-01-02-19-6-0">TORK-MASTER 1 2014-01-02 19.6.0</h1><h2 id="NAME">NAME</h2><p>tork-master - absorbs overhead and runs tests</p><h2 id="SYNOPSIS">SYNOPSIS</h2><p><code>tork-master</code> [<em>OPTION</em>]...</p><h2 id="DESCRIPTION">DESCRIPTION</h2><p>This program absorbs your Ruby application&#39;s test execution overhead once and
simply <a class="md2man-xref">fork(3)</a>s worker processses to run your tests thereafter.  As a result,
your tests run faster because they no longer spend any time absorbing the test
execution overhead: worker processes simply inherit the overhead when forked.</p><p>This program can be controlled remotely by multiple <a class="md2man-xref" href="../man1/tork-remote.1.html">tork-remote(1)</a> instances.</p><h3 id="Input">Input</h3><p>This program reads the following commands, which are single-line JSON arrays,
from stdin and then performs the associated actions.  For lines read from
stdin that are single-line JSON arrays, it splits each of them into an array
of words, using the same word-splitting algorithm as <a class="md2man-xref">sh(1)</a>, before processing
them.  For example, the line <code>a &quot;b c&quot;</code> is split into the <code>[&quot;a&quot;, &quot;b c&quot;]</code> array.</p><dl><dt><code>[&quot;test&quot;,</code> <em>test_file</em><code>,</code> <em>line_numbers</em><code>]</code></dt><dd>Forks a worker process to run tests that correspond to the given
<em>line_numbers</em> in the given <em>test_file</em>.  If <em>line_numbers</em> is empty, then
the entire <em>test_file</em> will be run.</dd></dl><dl><dt><code>[&quot;stop&quot;,</code> <em>signal</em><code>]</code></dt><dd>Stops all tests that are currently running by sending the given <em>signal</em>
(optional; defaults to &quot;SIGTERM&quot;) to their respective worker processes.</dd></dl><dl><dt><code>[&quot;quit&quot;]</code></dt><dd>Stops all tests that are currently running and exits.</dd></dl><h3 id="Output">Output</h3><p>This program prints the following messages, which are single-line JSON arrays,
to stdout.</p><dl><dt><code>[&quot;absorb&quot;]</code></dt><dd>Test execution overhead has been absorbed.  We are ready for testing!</dd></dl><dl><dt><code>[&quot;test&quot;,</code> <em>test_file</em><code>,</code> <em>line_numbers</em><code>,</code> <em>log_file</em><code>,</code> <em>worker_number</em><code>]</code></dt><dd>Test has begun running.  Its output (both stdout and stderr) is being
captured into <em>log_file</em> in real time, so you can watch it with <code>tail -f</code>.</dd></dl><dl><dt><code>[&quot;pass&quot;,</code> <em>test_file</em><code>,</code> <em>line_numbers</em><code>,</code> <em>log_file</em><code>,</code> <em>worker_number</em><code>,</code> <em>exit_code</em><code>,</code> <em>exit_info</em><code>]</code></dt><dd>Test has passed.</dd></dl><dl><dt><code>[&quot;fail&quot;,</code> <em>test_file</em><code>,</code> <em>line_numbers</em><code>,</code> <em>log_file</em><code>,</code> <em>worker_number</em><code>,</code> <em>exit_code</em><code>,</code> <em>exit_info</em><code>]</code></dt><dd>Test has failed.</dd></dl><h2 id="OPTIONS">OPTIONS</h2><dl><dt><code>-h</code>, <code>--help</code></dt><dd>Show this help manual.</dd></dl><h2 id="FILES">FILES</h2><dl><dt><em>.tork/config.rb</em></dt><dd>Optional Ruby script that is loaded inside the driver process on startup.
It can read and change the <code>ENV[&#39;TORK_CONFIGS&#39;]</code> environment variable.</dd></dl><dl><dt><em>.tork/master.rb</em></dt><dd>Optional Ruby script that is loaded inside the master process on startup.
It can read and change the following variables.</dd></dl>
<blockquote>
<dl><dt><code>Tork::Master::MAX_CONCURRENT_WORKERS</code></dt><dd>Maximum number of worker processes that are allowed to be running
simultaneously at any given time.  The default value is either the
number of processors detected on your system or 1 if detection failed.</dd></dl></blockquote>
<dl><dt><em>.tork/onfork.rb</em></dt><dd>Optional Ruby script that is loaded inside the master process just before a
worker process is forked.  It can read and change the following variables.</dd></dl>
<blockquote>
<dl><dt><code>$tork_test_file</code></dt><dd>Path of the test file that will be run by the worker process.</dd></dl><dl><dt><code>$tork_line_numbers</code></dt><dd>Array of line numbers in the test file that were requested to be run.</dd></dl><dl><dt><code>$tork_log_file</code></dt><dd>Path of the log file that will hold the output of the worker process.</dd></dl><dl><dt><code>$tork_worker_number</code></dt><dd>Sequence number of the worker process that will be forked shortly.</dd></dl></blockquote>
<dl><dt><em>.tork/worker.rb</em></dt><dd>Optional Ruby script that is loaded inside a worker process just after
it is forked.  It can read and change the following variables.</dd></dl>
<blockquote>
<dl><dt><code>$tork_test_file</code></dt><dd>Path of the test file that will be run by this worker process.</dd></dl><dl><dt><code>$tork_line_numbers</code></dt><dd>Array of line numbers in the test file that were requested to be run.</dd></dl><dl><dt><code>$tork_log_file</code></dt><dd>Path of the log file that will hold the output of this worker process.</dd></dl><dl><dt><code>$tork_worker_number</code></dt><dd>Sequence number of this worker process.</dd></dl></blockquote>
<h2 id="ENVIRONMENT">ENVIRONMENT</h2><p>See <a class="md2man-xref" href="../man1/tork.1.html">tork(1)</a>.</p><h2 id="SEE-ALSO">SEE ALSO</h2><p><a class="md2man-xref" href="../man1/tork.1.html">tork(1)</a>, <a class="md2man-xref" href="../man1/tork-remote.1.html">tork-remote(1)</a></p></div></body>
</html>
